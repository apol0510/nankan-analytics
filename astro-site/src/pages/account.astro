---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç† | NANKANã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹" description="ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®šã‚’ç®¡ç†">
    <div class="account-container">
        <!-- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="account-header">
            <h1>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç®¡ç†</h1>
            <p class="subtitle">ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã®ç¢ºèªã¨è¨­å®š</p>
        </div>

        <!-- èªè¨¼ãƒã‚§ãƒƒã‚¯ -->
        <div id="auth-loading" class="loading-section">
            <div class="spinner"></div>
            <p>èªè¨¼æƒ…å ±ã‚’ç¢ºèªä¸­...</p>
        </div>

        <div id="account-content" class="hidden">
            <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ± -->
            <div class="section">
                <h2 class="section-title">
                    <span class="section-icon">ğŸ‘¤</span>
                    ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
                </h2>
                <div class="user-info-card" id="user-info">
                    <div class="loading">ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
                </div>
            </div>

            <!-- ä¸€æ™‚çš„ãªãŠçŸ¥ã‚‰ã› -->
            <div class="section">
                <div class="notice">
                    <h3>ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸­</h3>
                    <p>ç¾åœ¨ã€æ±ºæ¸ˆã‚·ã‚¹ãƒ†ãƒ ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ä½œæ¥­ã‚’è¡Œã£ã¦ãŠã‚Šã¾ã™ã€‚</p>
                    <p>ãƒ—ãƒ©ãƒ³å¤‰æ›´ç­‰ã®ã‚µãƒ¼ãƒ“ã‚¹ã¯ä¸€æ™‚çš„ã«ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã›ã‚“ã€‚</p>
                    <p>ã”ä¸ä¾¿ã‚’ãŠã‹ã‘ã—ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ã€‚</p>
                </div>
            </div>
        </div>
    </div>
</BaseLayout>

<style>
    .account-container {
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 20px;
    }

    .account-header {
        text-align: center;
        margin-bottom: 50px;
    }

    .account-header h1 {
        font-size: 36px;
        font-weight: 700;
        background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 10px;
    }

    .subtitle {
        color: #94a3b8;
        font-size: 18px;
    }

    .loading-section {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 300px;
        color: #94a3b8;
    }

    .spinner {
        width: 40px;
        height: 40px;
        border: 3px solid rgba(59, 130, 246, 0.2);
        border-top: 3px solid #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 20px;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .hidden {
        display: none;
    }

    .section {
        background: rgba(30, 41, 59, 0.8);
        backdrop-filter: blur(10px);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        border: 1px solid rgba(59, 130, 246, 0.2);
    }

    .section-title {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 24px;
        font-weight: 600;
        color: #f1f5f9;
        margin-bottom: 25px;
    }

    .section-icon {
        font-size: 28px;
    }

    .user-info-card {
        background: rgba(15, 23, 42, 0.6);
        border-radius: 12px;
        padding: 25px;
    }

    .notice {
        background: rgba(245, 158, 11, 0.1);
        border: 1px solid rgba(245, 158, 11, 0.3);
        border-radius: 12px;
        padding: 20px;
        color: #f59e0b;
    }

    .notice h3 {
        margin: 0 0 10px 0;
        font-size: 20px;
    }

    .notice p {
        margin: 8px 0;
        color: #fbbf24;
    }

    .loading {
        text-align: center;
        color: #94a3b8;
        padding: 20px;
    }
</style>

<script>
    // Supabaseèªè¨¼ãƒã‚§ãƒƒã‚¯
    import { createClient } from 'https://cdn.skypack.dev/@supabase/supabase-js@2';
    
    const supabaseUrl = 'https://qysycsrhaatudnksbpqe.supabase.co';
    const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF5c3ljc3JoYWF0dWRua3NicHFlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTU5MzM3MjcsImV4cCI6MjA3MTUwOTcyN30.UDWi7FYqpJNpMhvMMaZoGMXwuD1R2PNH4Tk6Xs1u1pU';
    const supabase = createClient(supabaseUrl, supabaseAnonKey);

    async function checkAuth() {
        const { data: { user }, error } = await supabase.auth.getUser();
        
        const authLoading = document.getElementById('auth-loading');
        const accountContent = document.getElementById('account-content');
        
        if (user) {
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¡¨ç¤º
            const userInfo = document.getElementById('user-info');
            userInfo.innerHTML = `
                <p><strong>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹:</strong> ${user.email}</p>
                <p><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID:</strong> ${user.id}</p>
                <p><strong>ç™»éŒ²æ—¥:</strong> ${new Date(user.created_at).toLocaleDateString('ja-JP')}</p>
            `;
            
            authLoading.classList.add('hidden');
            accountContent.classList.remove('hidden');
        } else {
            authLoading.innerHTML = `
                <p style="color: #ef4444;">ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™</p>
                <a href="/auth/login" style="margin-top: 20px; display: inline-block; background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%); color: white; padding: 12px 30px; border-radius: 8px; text-decoration: none;">
                    ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹
                </a>
            `;
        }
    }

    document.addEventListener('DOMContentLoaded', checkAuth);
</script>