---
export const prerender = true;
import BaseLayout from '../layouts/BaseLayout.astro';
import AccessControl from '../components/AccessControl.astro';
import BettingSelectionQA from '../components/BettingSelectionQA.astro';
import allRacesData from '../data/allRacesPrediction.json';
import { processRaceData, generateSanrenpukuBets, getHorseConfidenceFromMark } from '../lib/shared-prediction-logic.js';

// å…±æœ‰ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†
const { sortedRaces } = processRaceData(allRacesData);

// æ—¥ä»˜ã¨ä¼šå ´ã‚’å–å¾—
const raceDate = allRacesData.raceDate;
const track = allRacesData.track;
const totalRaces = allRacesData.totalRaces || 12;

// æ—¥ä»˜ã‚’æ—¥æœ¬èªå½¢å¼ã«å¤‰æ›
const [year, month, day] = raceDate.split('-');
const formattedDate = `${year}å¹´${parseInt(month)}æœˆ${parseInt(day)}æ—¥`;

// å…¨ãƒ¬ãƒ¼ã‚¹ã®ä¸‰é€£è¤‡è²·ã„ç›®ç”Ÿæˆ
const sanrenpukuRaces = sortedRaces.map(raceData => {
    const sanrenpukuData = generateSanrenpukuBets(raceData.horses);
    return {
        ...raceData,
        sanrenpuku: sanrenpukuData
    };
});
---

<BaseLayout
    title={`ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¸‰é€£è¤‡äºˆæƒ³ | ${track} ${formattedDate}`}
    description={`AIæŠ€è¡“ã«ã‚ˆã‚‹${track}ç«¶é¦¬ã®è¶…å³é¸ä¸‰é€£è¤‡äºˆæƒ³ã€‚ç´¯ç©ã‚¹ã‚³ã‚¢ã«åŸºã¥ãå°‘ç‚¹æ•°è²·ã„ç›®ã§æœ€é©ãªçµ„ã¿åˆã‚ã›ã®ã¿ã‚’æä¾›ã€‚`}
>
    <AccessControl requiredPlan="Premium Sanrenpuku">
        <!-- ç”³ã—è¾¼ã¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆPremium Predictionsä¼šå“¡å‘ã‘ï¼‰ -->
        <div id="sanrenpuku-order" class="order-section" style="display: none;">
            <div class="order-container">
                <div class="order-header">
                    <div class="order-icon">ğŸ¯</div>
                    <h1 class="order-title">Premium Sanrenpuku</h1>
                    <p class="order-subtitle">AIä¸‰é€£è¤‡å³é¸äºˆæƒ³ - è²·ã„ç›®ã‚’çµã‚Šè¾¼ã‚“ã§çš„ä¸­ç‡ã‚¢ãƒƒãƒ—</p>
                </div>

                <div class="order-features">
                    <div class="feature-card">
                        <div class="feature-icon">ğŸ“Š</div>
                        <h3>éå»1å¹´é–“ã®å®Ÿç¸¾</h3>
                        <div class="feature-stats">
                            <span class="stat-value">çš„ä¸­ç‡72%</span>
                            <span class="stat-value">å›åç‡156%</span>
                        </div>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">ğŸ¯</div>
                        <h3>å³é¸è²·ã„ç›®</h3>
                        <p class="feature-text">ã‚ãšã‹7ã€œ9ç‚¹ã®å°‘ç‚¹æ•°ã§é«˜ç¢ºç‡çš„ä¸­ã‚’å®Ÿç¾</p>
                    </div>

                    <div class="feature-card">
                        <div class="feature-icon">ğŸ‡</div>
                        <h3>å…¨ãƒ¬ãƒ¼ã‚¹å¯¾å¿œ</h3>
                        <p class="feature-text">1Rã€œ12Rå…¨ãƒ¬ãƒ¼ã‚¹ã®ä¸‰é€£è¤‡è²·ã„ç›®ã‚’æä¾›</p>
                    </div>
                </div>

                <div class="order-description">
                    <h2>ã“ã‚“ãªæ–¹ã«ãŠã™ã™ã‚</h2>
                    <ul class="recommend-list">
                        <li>é¦¬å˜3æˆ¦ç•¥ã‹ã‚‰è²·ã„ç›®ã‚’çµã‚Šãã‚Œãªã„</li>
                        <li>ã‚ªãƒƒã‚ºç¢ºèªã—ã¦æˆ¦ç•¥ã‚’é¸ã¶ã®ãŒé¢å€’</li>
                        <li>ã‚‚ã£ã¨ã‚·ãƒ³ãƒ—ãƒ«ãªè²·ã„ç›®ãŒã»ã—ã„</li>
                        <li>ä¸‰é€£è¤‡ã§çš„ä¸­ç‡ã‚’å®‰å®šã•ã›ãŸã„</li>
                    </ul>
                </div>

                <div class="order-price-section">
                    <div class="price-card">
                        <div class="price-label">æœˆé¡æ–™é‡‘</div>
                        <div class="price-value">Â¥19,820<span class="price-unit">/æœˆ</span></div>
                        <div class="price-note">â€» Premium Predictionsä¼šå“¡æ§˜å‘ã‘ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ãƒ—ãƒ©ãƒ³</div>
                    </div>

                    <button onclick="openBankModal('Premium Plus', 68000, 'lifetime')" class="order-btn">
                        ä»Šã™ãç”³ã—è¾¼ã‚€ â†’
                    </button>
                    <p class="order-note">
                        â€» Stripeã®å®‰å…¨ãªæ±ºæ¸ˆãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™<br>
                        â€» ãŠç”³ã—è¾¼ã¿å¾Œã€ã™ãã«ä¸‰é€£è¤‡äºˆæƒ³ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™
                    </p>
                </div>
            </div>
        </div>

        <!-- ä¸‰é€£è¤‡äºˆæƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆPremium Sanrenpuku / Premium Fullä¼šå“¡å‘ã‘ï¼‰ -->
        <div id="sanrenpuku-content" class="page-container" style="display: none;">
            <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="header-section">
                <div class="ai-badge premium-select-badge">
                    <span class="pulse"></span>
                    <span class="ai-status">âœ¨ Premium Sanrenpuku</span>
                </div>
                <h1 class="race-title">{formattedDate} {track} - Premium ä¸‰é€£è¤‡å³é¸äºˆæƒ³</h1>
            </div>

            <!-- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ¬ãƒ¼ã‚¹ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ï¼ˆå³ä¸‹å›ºå®šï¼‰ -->
            <div class="floating-race-selector">
                <button class="floating-selector-toggle" id="raceSelectorToggle">
                    <span class="toggle-icon">ğŸ‡</span>
                    <span class="toggle-text">ãƒ¬ãƒ¼ã‚¹é¸æŠ</span>
                </button>
                <div class="floating-selector-menu" id="raceSelectorMenu" style="display: none;">
                    <div class="selector-header">ğŸ“ ãƒ¬ãƒ¼ã‚¹ã‚’é¸æŠ</div>
                    <div class="selector-grid">
                        {sanrenpukuRaces.map((raceData) => (
                            <button
                                class="selector-race-btn"
                                data-race-number={raceData.raceNumber}
                                onclick={`document.getElementById('race-${raceData.raceNumber}').scrollIntoView({behavior: 'smooth', block: 'start'}); document.getElementById('raceSelectorMenu').style.display = 'none';`}
                            >
                                {raceData.raceNumber}
                            </button>
                        ))}
                    </div>
                </div>
            </div>

            <!-- å…¨ãƒ¬ãƒ¼ã‚¹äºˆæƒ³ -->
            <div class="races-container">
                {sanrenpukuRaces.map((raceData, index) => {
                    const sanrenpuku = raceData.sanrenpuku;
                    const horses = raceData.horses;
                    const strategies = raceData.strategies;

                    return (
                        <div class="race-card" id={`race-${raceData.raceNumber}`}>
                            <div class="race-header">
                                <div class="race-number">{raceData.raceNumber}</div>
                                <div class="race-info">
                                    <h3 class="race-name">{raceData.raceName}</h3>
                                </div>
                            </div>

                            <!-- AIé¸å‡ºé¦¬åˆ†æï¼ˆæœ€åˆã«é…ç½®ï¼‰ -->
                            <div class="analysis-section">
                                <h4 class="section-title">ğŸ¤– AIãƒ¢ãƒ‡ãƒ«é¸å‡ºé¦¬ - è©³ç´°åˆ†æ</h4>

                                {/* æœ¬å‘½ï¼ˆæœ€ã‚‚å¤§ããè¡¨ç¤ºï¼‰ */}
                                {horses.main && (
                                    <div class="horse-card horse-card-main">
                                        <div class="horse-header">
                                            <span class="horse-mark-main">â—</span>
                                            <span class="horse-number-main">{horses.main.number}</span>
                                            <span class="horse-name-main">{horses.main.name}</span>
                                            <span class="horse-type-main">æœ¬å‘½</span>
                                        </div>
                                        <div class="ai-factors">
                                            {horses.main.factors && horses.main.factors.filter(factor =>
                                                factor.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢') ||
                                                factor.text.includes('ç·åˆè©•ä¾¡')
                                            ).map(factor => {
                                                const isScore = factor.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢');
                                                const isEvaluation = factor.text.includes('ç·åˆè©•ä¾¡');
                                                const factorClass = isScore ? 'factor factor-score' : isEvaluation ? 'factor factor-evaluation' : 'factor';
                                                const displayText = factor.text.replace(/^â˜…\s*/, '');
                                                const showIcon = !isScore && !isEvaluation;
                                                return (
                                                    <div class={factorClass}>
                                                        {showIcon && <span class="factor-icon">{factor.icon}</span>}
                                                        <span>{displayText}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                        {horses.main.importance && (
                                            <div class="feature-importance">
                                                <h5 style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 10px;">ç‰¹å¾´é‡é‡è¦åº¦</h5>
                                                {horses.main.importance.map(item => (
                                                    <div class="importance-bar">
                                                        <span class="importance-label">{item.label}</span>
                                                        <div class="importance-value">
                                                            <div class="importance-fill" style={`width: ${item.value * 100}%;`}>{Math.round(item.value * 100)}%</div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}

                                {/* å¯¾æŠ—ï¼ˆä¸­ã‚µã‚¤ã‚ºè¡¨ç¤ºï¼‰ */}
                                {horses.sub && (
                                    <div class="horse-card horse-card-sub">
                                        <div class="horse-header">
                                            <span class="horse-mark-sub">â—‹</span>
                                            <span class="horse-number-sub">{horses.sub.number}</span>
                                            <span class="horse-name-sub">{horses.sub.name}</span>
                                            <span class="horse-type-sub">å¯¾æŠ—</span>
                                        </div>
                                        <div class="ai-factors">
                                            {horses.sub.factors && horses.sub.factors.filter(factor =>
                                                factor.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢') ||
                                                factor.text.includes('ç·åˆè©•ä¾¡')
                                            ).map(factor => {
                                                const isScore = factor.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢');
                                                const isEvaluation = factor.text.includes('ç·åˆè©•ä¾¡');
                                                const factorClass = isScore ? 'factor factor-score' : isEvaluation ? 'factor factor-evaluation' : 'factor';
                                                const displayText = factor.text.replace(/^â˜…\s*/, '');
                                                const showIcon = !isScore && !isEvaluation;
                                                return (
                                                    <div class={factorClass}>
                                                        {showIcon && <span class="factor-icon">{factor.icon}</span>}
                                                        <span>{displayText}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                        {horses.sub.importance && (
                                            <div class="feature-importance">
                                                <h5 style="color: #94a3b8; font-size: 0.9rem; margin-bottom: 10px;">ç‰¹å¾´é‡é‡è¦åº¦</h5>
                                                {horses.sub.importance.map(item => (
                                                    <div class="importance-bar">
                                                        <span class="importance-label">{item.label}</span>
                                                        <div class="importance-value">
                                                            <div class="importance-fill" style={`width: ${item.value * 100}%;`}>{Math.round(item.value * 100)}%</div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}

                                {/* å˜ç©´å€™è£œé¦¬ï¼ˆã¾ã¨ã‚ã¦è¡¨ç¤ºï¼‰ */}
                                {(horses.hole1 || horses.hole2) && (
                                    <div class="horse-card horse-card-hole">
                                        <div class="horse-header">
                                            <span class="horse-mark-hole">â–²</span>
                                            <span class="minor-title title-hole">å˜ç©´å€™è£œé¦¬</span>
                                        </div>
                                        <div class="horse-grid">
                                            {horses.hole1 && (() => {
                                                const scoreText = horses.hole1.factors?.find(f => f.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢'))?.text;
                                                const score = scoreText ? scoreText.match(/\d+/)?.[0] : '';
                                                return (
                                                    <div class="horse-grid-item">
                                                        <span class="horse-number-small">{horses.hole1.number}</span>
                                                        <span class="horse-name-small">{horses.hole1.name}{score ? ` (${score}pt)` : ''}</span>
                                                    </div>
                                                );
                                            })()}
                                            {horses.hole2 && (() => {
                                                const scoreText = horses.hole2.factors?.find(f => f.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢'))?.text;
                                                const score = scoreText ? scoreText.match(/\d+/)?.[0] : '';
                                                return (
                                                    <div class="horse-grid-item">
                                                        <span class="horse-number-small">{horses.hole2.number}</span>
                                                        <span class="horse-name-small">{horses.hole2.name}{score ? ` (${score}pt)` : ''}</span>
                                                    </div>
                                                );
                                            })()}
                                        </div>
                                    </div>
                                )}

                                {/* é€£ä¸‹å€™è£œé¦¬ï¼ˆã¾ã¨ã‚ã¦è¡¨ç¤ºï¼‰ */}
                                {horses.connect && horses.connect.length > 0 && (
                                    <div class="horse-card horse-card-renka">
                                        <div class="horse-header">
                                            <span class="horse-mark-renka">â–³</span>
                                            <span class="minor-title title-renka">é€£ä¸‹å€™è£œé¦¬</span>
                                        </div>
                                        <div class="horse-grid">
                                            {horses.connect.map(horse => {
                                                const scoreText = horse.factors?.find(f => f.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢'))?.text;
                                                const score = scoreText ? scoreText.match(/\d+/)?.[0] : '';
                                                return (
                                                    <div class="horse-grid-item">
                                                        <span class="horse-number-small">{horse.number}</span>
                                                        <span class="horse-name-small">{horse.name}{score ? ` (${score}pt)` : ''}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                )}

                                {/* æŠ‘ãˆå€™è£œé¦¬ï¼ˆã¾ã¨ã‚ã¦è¡¨ç¤ºï¼‰ */}
                                {horses.reserve && horses.reserve.length > 0 && (
                                    <div class="horse-card horse-card-minor">
                                        <div class="horse-header">
                                            <span class="horse-mark-minor">Ã—</span>
                                            <span class="minor-title title-minor">æŠ‘ãˆå€™è£œé¦¬</span>
                                        </div>
                                        <div class="horse-grid">
                                            {horses.reserve.map(horse => {
                                                const scoreText = horse.factors?.find(f => f.text.includes('ç´¯ç©ã‚¹ã‚³ã‚¢'))?.text;
                                                const score = scoreText ? scoreText.match(/\d+/)?.[0] : '';
                                                return (
                                                    <div class="horse-grid-item">
                                                        <span class="horse-number-small">{horse.number}</span>
                                                        <span class="horse-name-small">{horse.name}{score ? ` (${score}pt)` : ''}</span>
                                                    </div>
                                                );
                                            })}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <!-- Premium Sanrenpukuçµã‚Šè¾¼ã¿ãƒœã‚¿ãƒ³ -->
                            <button class="premium-select-filter-btn" data-race-index={index}>
                                <span class="filter-icon">ğŸ¯</span>
                                <span class="filter-text">Premium Sanrenpuku çµã‚Šè¾¼ã‚€</span>
                                <span class="filter-arrow">â–¼</span>
                            </button>

                            <!-- Premium Sanrenpukuå³é¸è²·ã„ç›®ï¼ˆåˆæœŸéè¡¨ç¤ºãƒ»çµã‚Šè¾¼ã¿å¾Œè¡¨ç¤ºï¼‰ -->
                            <div class="premium-select-highlight" data-race-content={index} style="display: none;">
                                <div class="select-header">
                                    <div class="select-badge">âœ¨ Premium Sanrenpuku å³é¸è²·ã„ç›®</div>
                                </div>

                                <div class="select-bets-list">
                                    {sanrenpuku.narrowed && sanrenpuku.narrowed.map((bet, i) => {
                                        // å„è²·ã„ç›®ã®ç‚¹æ•°ã‚’è¨ˆç®—ï¼ˆã‚«ãƒ³ãƒã§åŒºåˆ‡ã‚‰ã‚ŒãŸé¦¬ç•ªå·ã®æ•°ï¼‰
                                        const parts = bet.split('-');
                                        const thirdHorses = parts[2] ? parts[2].split(',') : [];
                                        const points = thirdHorses.length;

                                        return (
                                            <div class="select-bet-item">
                                                <span class="bet-number">{i + 1}</span>
                                                <span class="bet-display">ä¸‰é€£è¤‡ {bet}</span>
                                                <span class="bet-score">{points}ç‚¹</span>
                                            </div>
                                        );
                                    })}
                                </div>

                                <div class="total-points-display">
                                    ğŸ’° åˆè¨ˆ: {sanrenpuku.total || 0}ç‚¹
                                </div>

                                <!-- æ å¤–ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤º -->
                                {sanrenpuku.compact && (
                                    <div class="compact-display-section">
                                        <h5 class="compact-title">ğŸ“‹ å…¨è²·ã„ç›®è©³ç´°</h5>

                                        <!-- 1æ®µç›®ï¼šæœ¬å‘½ãƒ–ãƒ­ãƒƒã‚¯ -->
                                        {sanrenpuku.compact.main && (
                                            <div class="compact-block">
                                                <div class="compact-horse-number">{sanrenpuku.compact.main.number}</div>
                                                <div class="compact-content">
                                                    <div class="compact-axis">{sanrenpuku.compact.main.axis}</div>
                                                    <div class="compact-targets">
                                                        {sanrenpuku.compact.main.targets}
                                                        {sanrenpuku.compact.main.osaeNumbers && sanrenpuku.compact.main.osaeNumbers.length > 0 && (
                                                            <span class="osae-note">({sanrenpuku.compact.main.osaeNumbers.join('.')}ã¯æŠ‘ãˆ)</span>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        )}

                                        <!-- 2æ®µç›®ï¼šå¯¾æŠ—ãƒ–ãƒ­ãƒƒã‚¯ -->
                                        {sanrenpuku.compact.sub && (
                                            <div class="compact-block">
                                                <div class="compact-horse-number">{sanrenpuku.compact.sub.number}</div>
                                                <div class="compact-content">
                                                    <div class="compact-axis">{sanrenpuku.compact.sub.axis}</div>
                                                    <div class="compact-targets">
                                                        {sanrenpuku.compact.sub.targets}
                                                        {sanrenpuku.compact.sub.osaeNumbers && sanrenpuku.compact.sub.osaeNumbers.length > 0 && (
                                                            <span class="osae-note">({sanrenpuku.compact.sub.osaeNumbers.join('.')}ã¯æŠ‘ãˆ)</span>
                                                        )}
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>

                        </div>
                    );
                })}
            </div>

            <!-- Premium Plus CTAã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="premium-plus-cta-section">
                <div class="premium-plus-cta-card">
                    <div class="cta-header">
                        <div class="cta-icon">ğŸ’</div>
                        <h2 class="cta-title">è¶…ç²¾å¯†AIã®Premium Plus</h2>
                        <p class="cta-subtitle">è¶…é«˜æ€§èƒ½AIãŒå°ã"æœ€é«˜ç¢ºç‡ã®1é"ã‚’ã€ã‚ãªãŸã«ã€‚</p>
                    </div>

                    <!-- æœ€æ–°ã®çš„ä¸­å®Ÿç¸¾ç”»åƒ -->
                    <div class="cta-results-preview">
                        <h3 class="preview-title">ğŸ“Š ç›´è¿‘3æˆ¦ã®å®Ÿç¸¾</h3>
                        <div class="preview-grid">
                            <div class="preview-image-card">
                                <img src="/upsell-images/upsell-20260223.png" alt="02/23çš„ä¸­å®Ÿç¸¾" onerror="this.parentElement.style.display='none'" />
                            </div>
                            <div class="preview-image-card">
                                <img src="/upsell-images/upsell-20260220.png" alt="02/20çš„ä¸­å®Ÿç¸¾" onerror="this.parentElement.style.display='none'" />
                            </div>
                            <div class="preview-image-card">
                                <img src="/upsell-images/upsell-20260219.png" alt="02/19çš„ä¸­å®Ÿç¸¾" onerror="this.parentElement.style.display='none'" />
                            </div>
                        </div>
                    </div>

                    <div class="cta-features">
                        <div class="cta-feature">
                            <span class="feature-icon">ğŸ¯</span>
                            <div class="feature-content">
                                <h3>1æ—¥1éé™å®š</h3>
                                <p>æ•°ä¸‡é€šã‚Šã®çµ„ã¿åˆã‚ã›ã‹ã‚‰å³é¸ã•ã‚ŒãŸã€ãŸã£ãŸ1ã¤ã®ç­”ãˆã€‚</p>
                            </div>
                        </div>
                        <div class="cta-feature">
                            <span class="feature-icon">ğŸ“Š</span>
                            <div class="feature-content">
                                <h3>æœŸå¾…ãƒªã‚¿ãƒ¼ãƒ³265%</h3>
                                <p>1éã§æŠ•è³‡é¡ã®ç´„2.7å€å›åã‚’å®Ÿç¾ã™ã‚‹ç²¾å¯†äºˆæƒ³ã€‚</p>
                            </div>
                        </div>
                        <div class="cta-feature">
                            <span class="feature-icon">ğŸ’°</span>
                            <div class="feature-content">
                                <h3>é€šå¸¸ä¾¡æ ¼Â¥98,000â†’ä»Šãªã‚‰Â¥68,000</h3>
                                <p>1éã§æŠ•è³‡é¡ã®ç´„3å€å›åã‚’ç›®æŒ‡ã™è¶…ç²¾å¯†äºˆæƒ³ã€‚</p>
                            </div>
                        </div>
                    </div>

                    <div class="cta-action">
                        <a href="/premium-plus" class="btn-premium-plus">
                            Premium Plus è©³ç´°ã‚’è¦‹ã‚‹
                            <span class="arrow">â†’</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- ãƒ—ãƒ©ãƒ³åˆ¤å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
        <script is:inline>
            (function() {
                console.log('ğŸ” Premium Sanrenpuku - ãƒ—ãƒ©ãƒ³åˆ¤å®šé–‹å§‹');

                // ãƒ—ãƒ©ãƒ³æƒ…å ±å–å¾—
                function getCurrentUserPlan() {
                    // 1. ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰
                    const demoKeys = Object.keys(localStorage).filter(key => key.startsWith('demo_subscription_'));
                    if (demoKeys.length > 0) {
                        try {
                            const demoData = JSON.parse(localStorage.getItem(demoKeys[0]));
                            return demoData.planType;
                        } catch (error) {
                            console.error('Demo data parsing error:', error);
                        }
                    }

                    // 2. æ—§å½¢å¼ã®test_subscription_
                    const testKeys = Object.keys(localStorage).filter(key => key.startsWith('test_subscription_'));
                    if (testKeys.length > 0) {
                        try {
                            const testData = JSON.parse(localStorage.getItem(testKeys[0]));
                            return testData.planType;
                        } catch (error) {
                            console.error('Test subscription parsing error:', error);
                        }
                    }

                    // 3. user-plan
                    const userPlanData = localStorage.getItem('user-plan');
                    if (userPlanData) {
                        try {
                            const userData = JSON.parse(userPlanData);
                            return userData.plan || 'free';
                        } catch (error) {
                            console.error('User plan parsing error:', error);
                        }
                    }

                    // 4. nankan_user
                    const nankanUser = localStorage.getItem('nankan_user');
                    if (nankanUser) {
                        try {
                            const userData = JSON.parse(nankanUser);
                            return userData.plan || 'free';
                        } catch (error) {
                            console.error('Nankan user parsing error:', error);
                        }
                    }

                    return null;
                }

                // ãƒ—ãƒ©ãƒ³åˆ¤å®šã¨è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
                function checkPlanAndDisplay() {
                    const userPlan = getCurrentUserPlan();
                    console.log('ğŸ“‹ ç¾åœ¨ã®ãƒ—ãƒ©ãƒ³:', userPlan);

                    const orderSection = document.getElementById('sanrenpuku-order');
                    const contentSection = document.getElementById('sanrenpuku-content');

                    if (!orderSection || !contentSection) {
                        console.error('âŒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                        return;
                    }

                    // Premium Sanrenpuku ã¾ãŸã¯ Premium Combo ã¾ãŸã¯ Premium Full ä¼šå“¡ã®å ´åˆ â†’ äºˆæƒ³è¡¨ç¤º
                    if (userPlan === 'Premium Sanrenpuku' || userPlan === 'Premium Combo' || userPlan === 'Premium Full') {
                        console.log('âœ… Premium Sanrenpuku/Combo/Fullä¼šå“¡ â†’ ä¸‰é€£è¤‡äºˆæƒ³è¡¨ç¤º');
                        orderSection.style.display = 'none';
                        contentSection.style.display = 'block';
                    }
                    // Premium Predictions ã¾ãŸã¯ Premium ä¼šå“¡ã®å ´åˆ â†’ sanrenpuku-demoã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
                    else if (userPlan === 'Premium Predictions' || userPlan === 'Premium' || userPlan === 'premium') {
                        console.log('ğŸ¯ Premiumä¼šå“¡ â†’ sanrenpuku-demoã¸ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ');
                        window.location.href = '/sanrenpuku-demo/';
                    }
                    // ãã®ä»–ã®å ´åˆï¼ˆAccessControlã§å¼¾ã‹ã‚Œã‚‹ã¯ãšã ãŒå¿µã®ãŸã‚ï¼‰
                    else {
                        console.log('âŒ ãƒ—ãƒ©ãƒ³ä¸æ˜ â†’ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç”³ã—è¾¼ã¿è¡¨ç¤º');
                        orderSection.style.display = 'block';
                        contentSection.style.display = 'none';
                    }
                }

                // DOMèª­ã¿è¾¼ã¿å®Œäº†å¾Œã«å®Ÿè¡Œ
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', checkPlanAndDisplay);
                } else {
                    checkPlanAndDisplay();
                }
            })();
        </script>
    </AccessControl>
</BaseLayout>
    <!-- éŠ€è¡ŒæŒ¯è¾¼ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div class="bank-modal" id="bankModal">
      <div class="bank-modal-content">
        <button class="bank-modal-close" onclick="closeBankModal()">Ã—</button>

        <h2 class="bank-modal-title">ğŸ¦ éŠ€è¡ŒæŒ¯è¾¼ã§ã®ãŠç”³ã—è¾¼ã¿</h2>
        <p class="modal-plan-info" id="modalPlanInfo"></p>

        <div class="bank-info-box">
          <div class="bank-info-item">
            <span class="bank-info-label">æŒ¯è¾¼å…ˆéŠ€è¡Œ</span>
            <span class="bank-info-value">ä¸‰äº•ä½å‹éŠ€è¡Œ
              <button class="copy-button" onclick="copyToClipboard('ä¸‰äº•ä½å‹éŠ€è¡Œ')">ã‚³ãƒ”ãƒ¼</button>
            </span>
          </div>
          <div class="bank-info-item">
            <span class="bank-info-label">æ”¯åº—å</span>
            <span class="bank-info-value">æ´²æœ¬æ”¯åº—
              <button class="copy-button" onclick="copyToClipboard('æ´²æœ¬æ”¯åº—')">ã‚³ãƒ”ãƒ¼</button>
            </span>
          </div>
          <div class="bank-info-item">
            <span class="bank-info-label">å£åº§ç¨®åˆ¥</span>
            <span class="bank-info-value">æ™®é€š</span>
          </div>
          <div class="bank-info-item">
            <span class="bank-info-label">å£åº§ç•ªå·</span>
            <span class="bank-info-value">5338892
              <button class="copy-button" onclick="copyToClipboard('5338892')">ã‚³ãƒ”ãƒ¼</button>
            </span>
          </div>
          <div class="bank-info-item">
            <span class="bank-info-label">å£åº§åç¾©</span>
            <span class="bank-info-value" style="font-size: 0.95rem;">ï¾-ï½¸ï½±ï¾‚ï¾Œï¾Ÿï½´-ï½±ï½²ï½»-ï¾‹ï¾ï½½ ï½±ï½»ï½² ï¾„ï½¼ï¾‹ï¾›
              <button class="copy-button" onclick="copyToClipboard('ï¾-ï½¸ï½±ï¾‚ï¾Œï¾Ÿï½´-ï½±ï½²ï½»-ï¾‹ï¾ï½½ ï½±ï½»ï½² ï¾„ï½¼ï¾‹ï¾›')">ã‚³ãƒ”ãƒ¼</button>
            </span>
          </div>
          <div class="bank-info-item" style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3);">
            <span class="bank-info-label">æŒ¯è¾¼é‡‘é¡</span>
            <span class="bank-info-value" style="color: #10b981; font-size: 1.3rem;" id="modalAmount">Â¥5,980</span>
          </div>
        </div>

        <div class="bank-steps">
          <div class="bank-steps-title">ğŸ“ ãŠç”³ã—è¾¼ã¿æ‰‹é †</div>
          <div class="bank-step">
            <span class="bank-step-number">1</span>
            <span>ä¸Šè¨˜ã®å£åº§æƒ…å ±ã«æŒ¯è¾¼é‡‘é¡ã‚’ãŠæŒ¯è¾¼ã¿ãã ã•ã„</span>
          </div>
          <div class="bank-step">
            <span class="bank-step-number">2</span>
            <span>æŒ¯è¾¼å®Œäº†å¾Œã€ä¸‹è¨˜ã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å¿…è¦æƒ…å ±ã‚’ã”é€ä¿¡ãã ã•ã„</span>
          </div>
          <div class="bank-step">
            <span class="bank-step-number">3</span>
            <span>å…¥é‡‘ç¢ºèªå–ã‚Œæ¬¡ç¬¬ã€å³æ™‚ã«ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’ãƒ¡ãƒ¼ãƒ«ã§ãŠé€ã‚Šã„ãŸã—ã¾ã™</span>
          </div>
        </div>

        <!-- éŠ€è¡ŒæŒ¯è¾¼ç”³ã—è¾¼ã¿ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="bank-form-section">
          <div class="bank-form-title">ğŸ’³ éŠ€è¡ŒæŒ¯è¾¼å®Œäº†ãƒ•ã‚©ãƒ¼ãƒ </div>

          <form id="bankTransferForm" class="bank-form">
            <div class="form-group">
              <label for="fullName" class="form-label">ãŠåå‰ <span class="required">*</span></label>
              <input type="text" id="fullName" name="fullName" class="form-input" required placeholder="å±±ç”° å¤ªéƒ">
            </div>

            <div class="form-group">
              <label for="email" class="form-label">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ <span class="required">*</span></label>
              <input type="email" id="email" name="email" class="form-input" required placeholder="example@email.com">
            </div>

            
            <div class="form-group">
                <label for="transferDate" class="form-label">æŒ¯è¾¼å®Œäº†æ—¥ <span class="required">*</span></label>
                <input type="date" id="transferDate" name="transferDate" class="form-input" required>
              </div>


            <div class="form-group">
              <label for="transferAmount" class="form-label">æŒ¯è¾¼é‡‘é¡ <span class="required">*</span></label>
              <input type="number" id="transferAmount" name="transferAmount" class="form-input" required readonly>
            </div>

            <div class="form-group">

            <div class="form-group">
              <label for="remarks" class="form-label">å‚™è€ƒãƒ»ã”è¦æœ›</label>
              <textarea id="remarks" name="remarks" class="form-input" rows="3" placeholder="ä½•ã‹ã”è¦æœ›ãŒã‚ã‚Šã¾ã—ãŸã‚‰ã”è¨˜å…¥ãã ã•ã„ï¼ˆä»»æ„ï¼‰"></textarea>
            </div>

            <button type="submit" class="form-submit-button" id="submitButton">
              <span class="submit-text">ğŸ“¨ ç”³ã—è¾¼ã¿ã‚’é€ä¿¡</span>
              <span class="submit-loading" style="display: none;">é€ä¿¡ä¸­...</span>
            </button>

            <div class="form-message" id="formMessage" style="display: none;"></div>
          </form>
        </div>

        <div class="bank-warning">
          <div class="bank-warning-title">âš ï¸ ã”æ³¨æ„äº‹é …</div>
          <div class="bank-warning-text">
            ãƒ»æŒ¯è¾¼æ‰‹æ•°æ–™ã¯ãŠå®¢æ§˜è² æ‹…ã¨ãªã‚Šã¾ã™<br>
            ãƒ»åœŸæ—¥ç¥æ—¥ã®å ´åˆã€ç¢ºèªãŒç¿Œå–¶æ¥­æ—¥ã¨ãªã‚‹å ´åˆãŒã”ã–ã„ã¾ã™<br>
            ãƒ»<strong>ãŠåå‰ã¨åŒã˜åç¾©ã§æŒ¯è¾¼ã‚’ãŠé¡˜ã„ã—ã¾ã™</strong><br>
            ãƒ»åç¾©ãŒç•°ãªã‚‹å ´åˆã¯ã€å‚™è€ƒæ¬„ã«ãã®æ—¨ã‚’ã”è¨˜å…¥ãã ã•ã„<br>
            ãƒ»ã”å…¥é‡‘å¾Œã®ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒ»è¿”é‡‘ã¯æ‰¿ã£ã¦ãŠã‚Šã¾ã›ã‚“
          </div>
        </div>
      </div>
    </div>
</BaseLayout>

<script is:inline>
  let currentPlan = '';
  let currentAmount = 0;
  let currentPlanType = 'monthly';

  function openBankModal(planName, amount, planType = 'monthly') {
    currentPlan = planName;
    currentAmount = amount;
    currentPlanType = planType;

    let periodText = '';
    if (planType === 'lifetime') {
      periodText = 'ï¼ˆæ°¸ä¹…ã‚¢ã‚¯ã‚»ã‚¹ï¼‰';
    } else if (planType === 'annual') {
      periodText = '/å¹´';
    } else {
      periodText = '/æœˆ';
    }

    document.getElementById('modalPlanInfo').textContent = `ãƒ—ãƒ©ãƒ³: ${planName} (Â¥${amount.toLocaleString()}${periodText})`;
    document.getElementById('modalAmount').textContent = `Â¥${amount.toLocaleString()}`;
    document.getElementById('transferAmount').value = amount;
    document.getElementById('bankModal').classList.add('active');
    document.body.style.overflow = 'hidden';
  }

  function closeBankModal() {
    document.getElementById('bankModal').classList.remove('active');
    document.body.style.overflow = 'auto';
  }

  function copyToClipboard(text) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.opacity = '0';
    document.body.appendChild(textarea);
    textarea.select();

    try {
      document.execCommand('copy');
      alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ: ' + text);
    } catch (err) {
      console.error('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ:', err);
    }

    document.body.removeChild(textarea);
  }

  // DOMContentLoadedå¾Œã«ãƒ•ã‚©ãƒ¼ãƒ å‡¦ç†ã‚’ç™»éŒ²
  document.addEventListener('DOMContentLoaded', () => {
    // ãƒ¢ãƒ¼ãƒ€ãƒ«å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    document.addEventListener('click', (e) => {
      const bankModal = document.getElementById('bankModal');
      if (e.target === bankModal) {
        closeBankModal();
      }
    });

    // Escapeã‚­ãƒ¼ã§é–‰ã˜ã‚‹
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeBankModal();
      }
    });

    // éŠ€è¡ŒæŒ¯è¾¼ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
    const bankTransferForm = document.getElementById('bankTransferForm');
    if (bankTransferForm) {
      bankTransferForm.addEventListener('submit', async (e) => {
        e.preventDefault();

        const submitButton = document.getElementById('submitButton');
        const submitText = submitButton.querySelector('.submit-text');
        const submitLoading = submitButton.querySelector('.submit-loading');
        const formMessage = document.getElementById('formMessage');

        submitButton.disabled = true;
        submitText.style.display = 'none';
        submitLoading.style.display = 'inline';
        formMessage.style.display = 'none';

        let periodText = '';
        if (currentPlanType === 'lifetime') {
          periodText = 'ï¼ˆæ°¸ä¹…ã‚¢ã‚¯ã‚»ã‚¹ï¼‰';
        } else if (currentPlanType === 'annual') {
          periodText = '/å¹´';
        } else {
          periodText = '/æœˆ';
        }

        const formData = {
          fullName: document.getElementById('fullName').value,
          email: document.getElementById('email').value,
          transferDate: document.getElementById('transferDate').value,
          transferTime: "00:00",  // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
          transferAmount: document.getElementById('transferAmount').value,
          transferName: document.getElementById('fullName').value,  // ãŠåå‰ã¨åŒã˜
          remarks: document.getElementById('remarks').value,
          productName: `${currentPlan} (Â¥${currentAmount.toLocaleString()}${periodText})`,
          timestamp: new Date().toISOString()
        };

        try {
          const response = await fetch('/.netlify/functions/bank-transfer-application', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(formData)
          });

          const result = await response.json();

          if (result.success) {
            formMessage.textContent = 'âœ… ãŠç”³ã—è¾¼ã¿ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚ç¢ºèªãƒ¡ãƒ¼ãƒ«ã‚’ãŠé€ã‚Šã—ã¾ã—ãŸã®ã§ã”ç¢ºèªãã ã•ã„ã€‚';
            formMessage.className = 'form-message success';
            formMessage.style.display = 'block';

            document.getElementById('bankTransferForm').reset();

            setTimeout(() => {
              closeBankModal();
              formMessage.style.display = 'none';
            }, 3000);
          } else {
            throw new Error(result.error || 'é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ');
          }
        } catch (error) {
          formMessage.textContent = 'âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message;
          formMessage.className = 'form-message error';
          formMessage.style.display = 'block';
        } finally {
          submitButton.disabled = false;
          submitText.style.display = 'inline';
          submitLoading.style.display = 'none';
        }
      });
    }
  });
</script>

<style is:global>
    .page-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    /* èƒŒæ™¯ãƒ‘ã‚¿ãƒ¼ãƒ³å¼·åŒ–ï¼ˆã‚¬ãƒ©ã‚¹ãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ åŠ¹æœã‚’å¯è¦–åŒ–ï¼‰ */
    body {
        background:
            linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, transparent 50%),
            linear-gradient(45deg, rgba(251, 191, 36, 0.05) 0%, transparent 50%),
            linear-gradient(225deg, rgba(16, 185, 129, 0.05) 0%, transparent 50%),
            radial-gradient(circle at 20% 50%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 80% 50%, rgba(239, 68, 68, 0.1) 0%, transparent 50%),
            #0f172a;
        background-attachment: fixed;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .header-section {
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        border-radius: 16px;
        padding: 40px;
        margin-bottom: 30px;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .premium-select-badge {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.25) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        color: rgb(251, 191, 36);
        padding: 8px 16px;
        border-radius: 20px;
        font-weight: 400;
        margin-bottom: 20px;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.5),
            0 2px 8px rgba(251, 191, 36, 0.15);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    .race-title {
        font-size: 2rem;
        margin-bottom: 20px;
        color: #fff;
    }

    .premium-select-description {
        background: rgba(251, 191, 36, 0.1);
        border-left: 4px solid #fbbf24;
        padding: 20px;
        border-radius: 8px;
        margin-bottom: 30px;
    }

    .select-intro {
        color: #e2e8f0;
        font-size: 1.1rem;
        line-height: 1.8;
    }

    .ai-metrics {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }

    .metric {
        text-align: center;
    }

    .metric-value {
        font-size: 1.8rem;
        font-weight: 700;
        color: #fbbf24;
        margin-bottom: 8px;
    }

    .metric-label {
        font-size: 0.9rem;
        color: #94a3b8;
    }

    /* ç‰¹å¾´èª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .feature-explanation {
        background: linear-gradient(135deg, rgba(30, 41, 59, 0.15) 0%, rgba(15, 23, 42, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.5),
            0 4px 16px rgba(0, 0, 0, 0.1);
    }

    .feature-title {
        font-size: 1.5rem;
        margin-bottom: 20px;
        color: #fbbf24;
    }

    .feature-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
    }

    .feature-card {
        background: linear-gradient(135deg, rgba(15, 23, 42, 0.15) 0%, rgba(30, 41, 59, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 12px;
        padding: 20px;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.4),
            0 2px 12px rgba(0, 0, 0, 0.1);
    }

    .feature-icon {
        font-size: 2rem;
        display: block;
        margin-bottom: 15px;
    }

    .feature-card h4 {
        font-size: 1.1rem;
        margin-bottom: 10px;
        color: #fbbf24;
    }

    .feature-card p {
        color: #cbd5e1;
        font-size: 0.9rem;
        line-height: 1.6;
    }

    /* ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ¬ãƒ¼ã‚¹ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ */
    .floating-race-selector {
        position: fixed;
        bottom: 30px;
        right: 30px;
        z-index: 1000;
    }

    .floating-selector-toggle {
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        color: #000;
        border: none;
        border-radius: 50px;
        padding: 15px 25px;
        font-size: 1rem;
        font-weight: 700;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        box-shadow: 0 4px 20px rgba(251, 191, 36, 0.4);
        transition: all 0.3s ease;
    }

    .floating-selector-toggle:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 25px rgba(245, 158, 11, 0.5);
    }

    .toggle-icon {
        font-size: 1.3rem;
    }

    .floating-selector-menu {
        position: absolute;
        bottom: 70px;
        right: 0;
        background: linear-gradient(135deg, rgba(30, 41, 59, 0.95) 0%, rgba(15, 23, 42, 0.98) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 16px;
        padding: 20px;
        min-width: 250px;
        box-shadow:
            inset 0 0 0 0.5px rgba(96, 165, 250, 0.4),
            0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .selector-header {
        color: #60a5fa;
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 15px;
        text-align: center;
    }

    .selector-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 10px;
    }

    .selector-race-btn {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(37, 99, 235, 0.25) 100%);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        color: rgb(96, 165, 250);
        border: none;
        border-radius: 8px;
        padding: 12px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        box-shadow:
            inset 0 0 0 0.5px rgba(96, 165, 250, 0.4),
            0 2px 8px rgba(96, 165, 250, 0.15);
        transition: all 0.2s ease;
    }

    .selector-race-btn:hover {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.25) 0%, rgba(37, 99, 235, 0.35) 100%);
        transform: scale(1.05);
        box-shadow:
            inset 0 0 0 0.5px rgba(96, 165, 250, 0.6),
            0 4px 12px rgba(96, 165, 250, 0.3);
    }

    /* ãƒ¬ãƒ¼ã‚¹ã‚«ãƒ¼ãƒ‰ */
    .races-container {
        display: flex;
        flex-direction: column;
        gap: 25px;
    }

    .race-card {
        background: linear-gradient(135deg, rgba(30, 41, 59, 0.15) 0%, rgba(15, 23, 42, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 16px;
        padding: 30px;
        box-shadow:
            inset 0 0 0 0.5px rgba(59, 130, 246, 0.4),
            0 4px 16px rgba(0, 0, 0, 0.1);
    }

    .race-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 20px;
    }

    .race-number {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(37, 99, 235, 0.25) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        color: rgb(96, 165, 250);
        padding: 10px 20px;
        border-radius: 12px;
        font-weight: 400;
        font-size: 1.2rem;
        box-shadow:
            inset 0 0 0 0.5px rgba(96, 165, 250, 0.5),
            0 2px 8px rgba(96, 165, 250, 0.15);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    .race-name {
        color: #e2e8f0;
        font-size: 1.1rem;
    }

    /* AIé¸å‡ºé¦¬åˆ†æã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .analysis-section {
        margin-bottom: 25px;
    }

    .section-title {
        color: #fbbf24;
        font-size: 1.1rem;
        margin-bottom: 15px;
        font-weight: 600;
    }

    /* é¦¬ã‚«ãƒ¼ãƒ‰ */
    .horse-card {
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.15) 0%, rgba(59, 130, 246, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 15px;
        box-shadow:
            inset 0 0 0 0.5px rgba(96, 165, 250, 0.4),
            0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .horse-card-main {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.2) 100%);
        box-shadow:
            inset 0 0 0 0.5px rgba(16, 185, 129, 0.5),
            0 2px 12px rgba(16, 185, 129, 0.15);
    }

    .horse-card-sub {
        background: linear-gradient(135deg, rgba(236, 72, 153, 0.15) 0%, rgba(219, 39, 119, 0.25) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        box-shadow:
            inset 0 0 0 0.5px rgba(236, 72, 153, 0.5),
            0 2px 12px rgba(236, 72, 153, 0.2);
    }

    .horse-card-hole {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.25) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.5),
            0 2px 12px rgba(251, 191, 36, 0.2);
    }

    .horse-card-renka {
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.15) 0%, rgba(124, 58, 237, 0.25) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        box-shadow:
            inset 0 0 0 0.5px rgba(139, 92, 246, 0.5),
            0 2px 12px rgba(139, 92, 246, 0.2);
    }

    .horse-card-minor {
        background: linear-gradient(135deg, rgba(100, 116, 139, 0.15) 0%, rgba(71, 85, 105, 0.2) 100%);
        box-shadow:
            inset 0 0 0 0.5px rgba(100, 116, 139, 0.4),
            0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .horse-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 15px;
    }

    .horse-mark-main {
        font-size: 1.5rem;
        color: rgb(16, 185, 129);
    }

    .horse-mark-sub {
        font-size: 1.3rem;
        color: rgb(236, 72, 153);
    }

    .horse-mark-hole {
        font-size: 1.2rem;
        color: rgb(251, 191, 36);
    }

    .horse-mark-renka {
        font-size: 1.2rem;
        color: rgb(139, 92, 246);
    }

    .horse-mark-minor {
        font-size: 1.2rem;
        color: rgb(148, 163, 184);
    }

    .horse-number-main {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.25) 100%);
        color: rgb(16, 185, 129);
        padding: 6px 12px;
        border-radius: 8px;
        font-weight: 600;
        font-size: 1.1rem;
    }

    .horse-number-sub {
        background: linear-gradient(135deg, rgba(236, 72, 153, 0.15) 0%, rgba(219, 39, 119, 0.25) 100%);
        color: rgb(236, 72, 153);
        padding: 5px 10px;
        border-radius: 6px;
        font-weight: 600;
        font-size: 1rem;
    }

    .horse-name-main {
        color: rgb(16, 185, 129);
        font-weight: 600;
        font-size: 1.1rem;
        flex: 1;
    }

    .horse-name-sub {
        color: rgb(236, 72, 153);
        font-weight: 500;
        font-size: 1rem;
        flex: 1;
    }

    .horse-type-main, .horse-type-sub, .horse-type-hole {
        background: rgba(255, 255, 255, 0.1);
        color: #cbd5e1;
        padding: 4px 10px;
        border-radius: 6px;
        font-size: 0.8rem;
        font-weight: 600;
    }

    .minor-title {
        font-size: 0.95rem;
        font-weight: 600;
    }

    .title-hole {
        color: rgb(251, 191, 36);
    }

    .title-renka {
        color: rgb(139, 92, 246);
    }

    .title-minor {
        color: #94a3b8;
    }

    .horse-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 10px;
        margin-top: 10px;
    }

    .horse-grid-item {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .horse-number-small {
        background: rgba(255, 255, 255, 0.1);
        color: #e2e8f0;
        padding: 3px 8px;
        border-radius: 4px;
        font-size: 0.85rem;
        font-weight: 600;
    }

    .horse-name-small {
        color: #cbd5e1;
        font-size: 0.85rem;
    }

    .ai-factors {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .factor {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 0.9rem;
        color: #cbd5e1;
    }

    .factor-icon {
        font-size: 1rem;
    }

    /* â˜… ç·åˆè©•ä¾¡ã¨ç´¯ç©ã‚¹ã‚³ã‚¢ã®å›²ã¿ã‚¹ã‚¿ã‚¤ãƒ« */
    .factor-score,
    .factor-evaluation {
        padding: 8px 14px;
        border-radius: 8px;
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(5, 150, 105, 0.2) 100%);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        box-shadow:
            inset 0 0 0 0.5px rgba(16, 185, 129, 0.5),
            0 2px 10px rgba(16, 185, 129, 0.15);
        font-weight: 600;
        color: rgb(16, 185, 129);
        text-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    }

    .factor-score .factor-icon,
    .factor-evaluation .factor-icon {
        font-size: 1.1rem;
        filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }

    .feature-importance {
        margin-top: 15px;
    }

    .importance-bar {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 8px;
    }

    .importance-label {
        min-width: 100px;
        font-size: 0.85rem;
        color: #94a3b8;
    }

    .importance-value {
        flex: 1;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 10px;
        height: 20px;
        position: relative;
        overflow: hidden;
    }

    .importance-fill {
        background: linear-gradient(90deg, #fbbf24, #f59e0b);
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding-right: 8px;
        font-size: 0.75rem;
        color: #000;
        font-weight: 600;
        border-radius: 10px;
    }

    /* Premium Sanrenpukuçµã‚Šè¾¼ã¿ãƒœã‚¿ãƒ³ */
    .premium-select-filter-btn {
        width: 100%;
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        border: none;
        border-radius: 12px;
        padding: 18px 25px;
        margin-bottom: 20px;
        color: #000;
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
    }

    .premium-select-filter-btn:hover {
        background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
    }

    .premium-select-filter-btn:active {
        transform: translateY(0);
    }

    .premium-select-filter-btn.filtering {
        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        animation: pulse 1s ease-in-out infinite;
    }

    .premium-select-filter-btn.filtered {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

    @keyframes pulse {
        0%, 100% {
            opacity: 1;
        }
        50% {
            opacity: 0.7;
        }
    }

    .filter-icon {
        font-size: 1.3rem;
    }

    .filter-text {
        flex: 1;
        text-align: center;
    }

    .filter-arrow {
        transition: transform 0.3s ease;
    }

    .premium-select-filter-btn.filtered .filter-arrow {
        transform: rotate(180deg);
    }

    /* Premium Sanrenpukuå³é¸è²·ã„ç›® */
    .premium-select-highlight {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 16px;
        padding: 25px;
        margin-bottom: 30px;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.5),
            0 4px 16px rgba(251, 191, 36, 0.15);
        animation: slideDown 0.5s ease;
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .select-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 15px;
    }

    .select-badge {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.25) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        color: rgb(251, 191, 36);
        padding: 10px 20px;
        border-radius: 12px;
        font-weight: 400;
        font-size: 1.1rem;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.5),
            0 2px 8px rgba(251, 191, 36, 0.15);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    .select-bets-list {
        display: flex;
        flex-direction: column;
        gap: 10px;
        margin-top: 15px;
    }

    .select-bet-item {
        background: linear-gradient(135deg, rgba(15, 23, 42, 0.15) 0%, rgba(30, 41, 59, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 10px;
        padding: 14px 18px;
        display: flex;
        align-items: center;
        gap: 15px;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.4),
            0 2px 12px rgba(0, 0, 0, 0.1);
    }

    .bet-number {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.25) 100%);
        color: rgb(251, 191, 36);
        padding: 6px 12px;
        border-radius: 8px;
        font-weight: 600;
        min-width: 35px;
        text-align: center;
    }

    .bet-display {
        flex: 1;
        color: #e2e8f0;
        font-size: 1rem;
        font-family: 'Courier New', monospace;
    }

    .bet-score {
        color: #94a3b8;
        font-size: 0.9rem;
        font-weight: 600;
    }

    .total-points-display {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.25) 100%);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border-radius: 10px;
        padding: 15px;
        margin-top: 20px;
        text-align: center;
        font-size: 1.2rem;
        color: rgb(251, 191, 36);
        font-weight: 400;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.5),
            0 2px 8px rgba(251, 191, 36, 0.15);
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    }

    /* ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .compact-display-section {
        background: linear-gradient(135deg, rgba(30, 41, 59, 0.15) 0%, rgba(15, 23, 42, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 12px;
        padding: 20px;
        margin-top: 20px;
        box-shadow:
            inset 0 0 0 0.5px rgba(100, 116, 139, 0.4),
            0 2px 12px rgba(0, 0, 0, 0.1);
    }

    .compact-title {
        color: #60a5fa;
        font-size: 1rem;
        margin-bottom: 15px;
        font-weight: 600;
    }

    .compact-block {
        display: flex;
        align-items: flex-start;
        gap: 15px;
        margin-bottom: 15px;
    }

    .compact-horse-number {
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.15) 0%, rgba(59, 130, 246, 0.25) 100%);
        color: rgb(96, 165, 250);
        padding: 8px 15px;
        border-radius: 8px;
        font-weight: 700;
        font-size: 1.1rem;
        min-width: 45px;
        text-align: center;
    }

    .compact-content {
        flex: 1;
    }

    .compact-label {
        color: #94a3b8;
        font-size: 0.85rem;
        margin-bottom: 5px;
    }

    .compact-axis {
        color: #e2e8f0;
        font-size: 0.95rem;
        margin-bottom: 5px;
    }

    .compact-targets {
        color: #cbd5e1;
        font-size: 0.9rem;
        line-height: 1.5;
    }

    .osae-note {
        color: #94a3b8;
        font-size: 0.8rem;
        font-style: italic;
        margin-left: 8px;
    }

    /* ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰æ¡ˆå†… */
    .upgrade-notice {
        background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(245, 158, 11, 0.2) 100%);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-radius: 16px;
        padding: 30px;
        text-align: center;
        box-shadow:
            inset 0 0 0 0.5px rgba(251, 191, 36, 0.5),
            0 4px 16px rgba(251, 191, 36, 0.15);
    }

    .upgrade-notice h3 {
        color: #fbbf24;
        font-size: 1.5rem;
        margin-bottom: 15px;
    }

    .upgrade-notice p {
        color: #cbd5e1;
        font-size: 1rem;
        line-height: 1.6;
        margin-bottom: 10px;
    }

    .upgrade-notice strong {
        color: #fbbf24;
        font-weight: 700;
    }

    /* Premium Plus CTAã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
    .premium-plus-cta-section {
        margin: 60px auto 40px;
        max-width: 900px;
    }

    .premium-plus-cta-card {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(234, 88, 12, 0.2) 100%);
        border: 1px solid rgba(245, 158, 11, 0.3);
        border-radius: 20px;
        padding: 40px;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        transition: all 0.3s ease;
    }

    .premium-plus-cta-card:hover {
        border-color: rgba(245, 158, 11, 0.5);
        transform: translateY(-5px);
        box-shadow: 0 12px 30px rgba(245, 158, 11, 0.25);
    }

    /* çš„ä¸­å®Ÿç¸¾ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ */
    .cta-results-preview {
        margin: 30px 0;
    }

    .preview-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: #fbbf24;
        text-align: center;
        margin-bottom: 20px;
    }

    .preview-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin-bottom: 30px;
    }

    .preview-image-card {
        background: rgba(15, 23, 42, 0.6);
        border-radius: 12px;
        padding: 10px;
        border: 1px solid rgba(245, 158, 11, 0.3);
        transition: all 0.3s ease;
        overflow: hidden;
    }

    .preview-image-card:hover {
        transform: translateY(-4px);
        border-color: rgba(245, 158, 11, 0.5);
        box-shadow: 0 8px 20px rgba(245, 158, 11, 0.2);
    }

    .preview-image-card img {
        width: 100%;
        height: auto;
        border-radius: 8px;
        display: block;
    }

    .cta-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .cta-icon {
        font-size: 3rem;
        margin-bottom: 15px;
    }

    .cta-title {
        font-size: 2rem;
        font-weight: 800;
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 10px;
    }

    .cta-subtitle {
        font-size: 1.1rem;
        color: #cbd5e1;
        font-weight: 400;
    }

    .cta-features {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
        margin-bottom: 40px;
    }

    .cta-feature {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 10px;
    }

    .cta-feature .feature-icon {
        font-size: 2.5rem;
    }

    .cta-feature h3 {
        font-size: 1.1rem;
        font-weight: 700;
        color: #fbbf24;
        margin: 0 0 5px 0;
    }

    .cta-feature p {
        font-size: 0.9rem;
        color: #cbd5e1;
        margin: 0;
        line-height: 1.5;
    }

    .cta-action {
        text-align: center;
    }

    .btn-premium-plus {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
        color: #000;
        padding: 18px 40px;
        border-radius: 12px;
        text-decoration: none;
        font-size: 1.1rem;
        font-weight: 700;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3);
    }

    .btn-premium-plus:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
    }

    .btn-premium-plus .arrow {
        transition: transform 0.3s ease;
    }

    .btn-premium-plus:hover .arrow {
        transform: translateX(5px);
    }

    /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
    @media (max-width: 768px) {
        .header-section {
            padding: 25px 15px;
        }

        .race-title {
            font-size: 1.5rem;
        }

        .ai-metrics {
            grid-template-columns: repeat(2, 1fr);
        }

        .feature-grid {
            grid-template-columns: 1fr;
        }

        .race-card {
            padding: 20px;
        }

        .floating-race-selector {
            bottom: 20px;
            right: 20px;
        }

        .floating-selector-toggle {
            padding: 12px 20px;
            font-size: 0.95rem;
        }

        .selector-grid {
            grid-template-columns: repeat(3, 1fr);
        }

        .horse-grid {
            grid-template-columns: 1fr;
        }

        .premium-plus-cta-card {
            padding: 30px 20px;
        }

        .cta-title {
            font-size: 1.5rem;
        }

        .cta-subtitle {
            font-size: 1rem;
        }

        .preview-grid {
            grid-template-columns: 1fr;
            gap: 12px;
        }

        .preview-title {
            font-size: 1.1rem;
        }

        .cta-features {
            grid-template-columns: 1fr;
            gap: 20px;
        }

        .btn-premium-plus {
            width: 100%;
            justify-content: center;
            font-size: 1rem;
            padding: 16px 30px;
        }
    }

    /* ç”³ã—è¾¼ã¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚¹ã‚¿ã‚¤ãƒ« */
    .order-section {
        min-height: 100vh;
        padding: 40px 20px;
        background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    }

    .order-container {
        max-width: 900px;
        margin: 0 auto;
        background: rgba(30, 41, 59, 0.8);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(59, 130, 246, 0.3);
        border-radius: 20px;
        padding: 50px 40px;
    }

    .order-header {
        text-align: center;
        margin-bottom: 50px;
    }

    .order-icon {
        font-size: 4rem;
        margin-bottom: 20px;
    }

    .order-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: #f1f5f9;
        margin-bottom: 15px;
        background: linear-gradient(to right, #3b82f6, #8b5cf6);
        background-clip: text;
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .order-subtitle {
        font-size: 1.2rem;
        color: #94a3b8;
        margin-bottom: 0;
    }

    .order-features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 25px;
        margin-bottom: 50px;
    }

    .feature-card {
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid rgba(59, 130, 246, 0.2);
        border-radius: 15px;
        padding: 30px;
        text-align: center;
        transition: all 0.3s ease;
    }

    .feature-card:hover {
        transform: translateY(-5px);
        border-color: rgba(59, 130, 246, 0.5);
        box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
    }

    .feature-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
    }

    .feature-card h3 {
        font-size: 1.2rem;
        color: #e2e8f0;
        margin-bottom: 15px;
    }

    .feature-stats {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: #10b981;
    }

    .feature-text {
        color: #cbd5e1;
        line-height: 1.6;
        margin: 0;
    }

    .order-description {
        background: rgba(15, 23, 42, 0.4);
        border-left: 4px solid #f59e0b;
        padding: 30px;
        border-radius: 10px;
        margin-bottom: 50px;
    }

    .order-description h2 {
        color: #fbbf24;
        font-size: 1.5rem;
        margin-bottom: 20px;
    }

    .recommend-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .recommend-list li {
        color: #cbd5e1;
        font-size: 1.1rem;
        padding: 12px 0;
        border-bottom: 1px solid rgba(148, 163, 184, 0.1);
        position: relative;
        padding-left: 30px;
    }

    .recommend-list li:last-child {
        border-bottom: none;
    }

    .recommend-list li::before {
        content: 'âœ“';
        position: absolute;
        left: 0;
        color: #10b981;
        font-weight: 700;
        font-size: 1.3rem;
    }

    .order-price-section {
        text-align: center;
        margin-top: 50px;
    }

    .price-card {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
        border: 2px solid rgba(59, 130, 246, 0.4);
        border-radius: 15px;
        padding: 40px;
        margin-bottom: 30px;
    }

    .price-label {
        color: #94a3b8;
        font-size: 1rem;
        margin-bottom: 10px;
    }

    .price-value {
        font-size: 4rem;
        font-weight: 700;
        color: #f1f5f9;
        margin-bottom: 10px;
    }

    .price-unit {
        font-size: 1.5rem;
        color: #94a3b8;
    }

    .price-note {
        color: #94a3b8;
        font-size: 0.9rem;
        margin: 0;
    }

    .order-btn {
        display: inline-block;
        background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%);
        color: white;
        font-size: 1.3rem;
        font-weight: 700;
        padding: 18px 60px;
        border-radius: 12px;
        text-decoration: none;
        transition: all 0.3s ease;
        border: 2px solid rgba(245, 158, 11, 0.5);
        margin-bottom: 20px;
    }

    .order-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 15px 40px rgba(245, 158, 11, 0.4);
        border-color: #f59e0b;
    }

    .order-note {
        color: #94a3b8;
        font-size: 0.9rem;
        line-height: 1.6;
        margin: 0;
    }

    /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
    @media (max-width: 768px) {
        .order-container {
            padding: 30px 20px;
        }

        .order-title {
            font-size: 2rem;
        }

        .order-subtitle {
            font-size: 1rem;
        }

        .order-features {
            grid-template-columns: 1fr;
        }

        .price-value {
            font-size: 3rem;
        }

        .order-btn {
            font-size: 1.1rem;
            padding: 15px 40px;
        }
    }
</style>

<script is:inline>
    document.addEventListener('DOMContentLoaded', function() {
        // ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ¬ãƒ¼ã‚¹ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã®ãƒˆã‚°ãƒ«
        const selectorToggle = document.getElementById('raceSelectorToggle');
        const selectorMenu = document.getElementById('raceSelectorMenu');

        if (selectorToggle && selectorMenu) {
            selectorToggle.addEventListener('click', function() {
                if (selectorMenu.style.display === 'none') {
                    selectorMenu.style.display = 'block';
                } else {
                    selectorMenu.style.display = 'none';
                }
            });

            // ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¤–ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.floating-race-selector')) {
                    selectorMenu.style.display = 'none';
                }
            });
        }

        // Premium Sanrenpukuçµã‚Šè¾¼ã¿ãƒœã‚¿ãƒ³ï¼ˆ3æ®µéšã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
        const filterBtns = document.querySelectorAll('.premium-select-filter-btn');

        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const raceIndex = this.getAttribute('data-race-index');
                const content = document.querySelector(`[data-race-content="${raceIndex}"]`);
                const filterText = this.querySelector('.filter-text');

                if (content) {
                    if (content.style.display === 'none') {
                        // æ®µéš1: çµã‚Šè¾¼ã‚€ â†’ çµã‚Šè¾¼ã¿ä¸­ï¼ˆé’ãƒ»pulseï¼‰
                        this.classList.add('filtering');
                        filterText.textContent = 'Premium Sanrenpuku çµã‚Šè¾¼ã¿ä¸­';

                        // æ®µéš2: 1.6ç§’å¾Œã« çµã‚Šè¾¼ã¿ä¸­ â†’ çµã‚Šè¾¼ã¿å®Œäº†ï¼ˆç·‘ï¼‰
                        setTimeout(() => {
                            this.classList.remove('filtering');
                            this.classList.add('filtered');
                            filterText.textContent = 'Premium Sanrenpuku çµã‚Šè¾¼ã¿å®Œäº†';

                            // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤º
                            content.style.display = 'block';
                        }, 1600);
                    } else {
                        // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„éè¡¨ç¤º â†’ åˆæœŸçŠ¶æ…‹ã«æˆ»ã™
                        content.style.display = 'none';
                        this.classList.remove('filtered');
                        filterText.textContent = 'Premium Sanrenpuku çµã‚Šè¾¼ã‚€';
                    }
                }
            });
        });
    });
</script>
