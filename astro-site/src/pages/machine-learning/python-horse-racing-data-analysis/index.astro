---
export const prerender = true;
import BaseLayout from '../../../layouts/BaseLayout.astro';

const title = 'Pythonã§å§‹ã‚ã‚‹ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿åˆ†æ - pandasåŸºç¤ã‹ã‚‰XGBoostã¾ã§ | NANKANã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹';
const description = 'pandasã¨scikit-learnã‚’ä½¿ã£ãŸç«¶é¦¬ãƒ‡ãƒ¼ã‚¿åˆ†æã®åŸºç¤ã‚’è§£èª¬ã€‚ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ã‹ã‚‰ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã€XGBoostã«ã‚ˆã‚‹äºˆæƒ³ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰ã¾ã§å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ä¾‹ä»˜ãã§è©³è§£ã€‚';
---

<BaseLayout title={title} description={description}>
    <article class="article-content">
        <header class="article-header">
            <div class="breadcrumb">
                <a href="/">ãƒ›ãƒ¼ãƒ </a> â†’ <a href="/machine-learning">æ©Ÿæ¢°å­¦ç¿’</a> â†’ Pythonã§å§‹ã‚ã‚‹ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿åˆ†æ
            </div>
            <span class="article-category">æ©Ÿæ¢°å­¦ç¿’</span>
            <h1 class="article-title">Pythonã§å§‹ã‚ã‚‹ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿åˆ†æ - pandasåŸºç¤ã‹ã‚‰XGBoostã¾ã§</h1>
            <div class="article-meta">
                <span>ğŸ“… 2025å¹´1æœˆ15æ—¥</span>
                <span>â±ï¸ 15åˆ†ã§èª­ã‚ã‚‹</span>
                <span>ğŸ·ï¸ Python, pandas, XGBoost, æ©Ÿæ¢°å­¦ç¿’</span>
            </div>
        </header>

        <div class="article-body">
            <section>
                <h2>ğŸ¯ ã¯ã˜ã‚ã«</h2>
                <p>
                    ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿åˆ†æã¯ã€æ©Ÿæ¢°å­¦ç¿’ã®å®Ÿè·µçš„ãªå­¦ç¿’ã«æœ€é©ãªé¡Œæã§ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã€Pythonã®pandasãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ãŸåŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†ã‹ã‚‰ã€
                    XGBoostã‚’æ´»ç”¨ã—ãŸé«˜ç²¾åº¦äºˆæƒ³ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã¾ã§ã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¨ã¨ã‚‚ã«è§£èª¬ã—ã¾ã™ã€‚
                </p>

                <div class="highlight-box">
                    <h3>ã“ã®è¨˜äº‹ã§å­¦ã¹ã‚‹ã“ã¨</h3>
                    <ul>
                        <li>pandasã«ã‚ˆã‚‹ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†æ‰‹æ³•</li>
                        <li>ç«¶é¦¬ç‰¹æœ‰ã®ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</li>
                        <li>scikit-learnã§ã®åŸºæœ¬çš„ãªæ©Ÿæ¢°å­¦ç¿’</li>
                        <li>XGBoostã«ã‚ˆã‚‹é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰</li>
                        <li>ãƒ¢ãƒ‡ãƒ«è©•ä¾¡ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„</li>
                    </ul>
                </div>
            </section>

            <section>
                <h2>ğŸ“Š 1. ãƒ‡ãƒ¼ã‚¿æº–å‚™ã¨pandasåŸºç¤</h2>

                <h3>å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>
                <pre><code># å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pandas numpy scikit-learn xgboost matplotlib seaborn</code></pre>

                <h3>åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿</h3>
                <pre><code>import pandas as pd
import numpy as np
from datetime import datetime

# ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
race_data = pd.read_csv('race_results.csv')
horse_data = pd.read_csv('horse_info.csv')

# ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬æƒ…å ±ç¢ºèª
print("ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿å½¢çŠ¶", race_data.shape)
print("é¦¬ãƒ‡ãƒ¼ã‚¿å½¢çŠ¶", horse_data.shape)</code></pre>

                <h3>ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†</h3>
                <pre><code># æ¬ æå€¤ã®ç¢ºèªã¨å‡¦ç†
print("æ¬ æå€¤ã®æ•°")
print(race_data.isnull().sum())

# æ—¥ä»˜å‹ã¸ã®å¤‰æ›
race_data['race_date'] = pd.to_datetime(race_data['race_date'])

# ä¸è¦ãªãƒ‡ãƒ¼ã‚¿ã®é™¤å»
race_data = race_data.dropna(subset=['horse_id', 'finish_position'])</code></pre>
            </section>

            <section>
                <h2>ğŸ”§ 2. ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</h2>

                <h3>åŸºæœ¬çš„ãªç‰¹å¾´é‡ä½œæˆ</h3>
                <pre><code>def create_basic_features(df):
    # é¦¬é½¢ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
    df['age_group'] = pd.cut(df['horse_age'], bins=[0, 3, 5, 7, 20],
                            labels=['young', 'prime', 'mature', 'veteran'])

    # æ–¤é‡å·®
    df['weight_diff'] = df['jockey_weight'] - df['jockey_weight'].mean()

    # é¦¬ä½“é‡å¤‰åŒ–
    df['weight_change'] = df.groupby('horse_id')['horse_weight'].diff()

    return df

race_data = create_basic_features(race_data)</code></pre>

                <h3>éå»æˆç¸¾ç‰¹å¾´é‡</h3>
                <pre><code>def create_performance_features(df):
    # ã‚½ãƒ¼ãƒˆ
    df = df.sort_values(['horse_id', 'race_date'])

    # éå»ã®ãƒ¬ãƒ¼ã‚¹æˆç¸¾
    df['past_3_avg_finish'] = df.groupby('horse_id')['finish_position'].rolling(3).mean().shift(1)
    df['past_5_avg_finish'] = df.groupby('horse_id')['finish_position'].rolling(5).mean().shift(1)

    # å‹ç‡è¨ˆç®—
    df['win_rate'] = df.groupby('horse_id').apply(
        lambda x: (x['finish_position'] == 1).rolling(5).mean().shift(1)
    ).reset_index(level=0, drop=True)

    return df

race_data = create_performance_features(race_data)</code></pre>
            </section>

            <section>
                <h2>ğŸš€ 3. XGBoostã«ã‚ˆã‚‹é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«</h2>

                <h3>XGBoostãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰</h3>
                <pre><code>import xgboost as xgb
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

# ç›®çš„å¤‰æ•°ã®ä½œæˆï¼ˆ1ç€ãªã‚‰1ã€ãã‚Œä»¥å¤–ã¯0ï¼‰
race_data['target'] = (race_data['finish_position'] == 1).astype(int)

# ç‰¹å¾´é‡é¸æŠ
feature_columns = [
    'horse_age', 'jockey_weight', 'horse_weight', 'odds',
    'weight_diff', 'weight_change', 'past_3_avg_finish',
    'past_5_avg_finish', 'win_rate'
]

# æ¬ æå€¤å‡¦ç†
data_clean = race_data[feature_columns + ['target']].dropna()
X = data_clean[feature_columns]
y = data_clean['target']

# è¨“ç·´ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42, stratify=y
)

# XGBoostãƒ¢ãƒ‡ãƒ«ã®è¨“ç·´
xgb_model = xgb.XGBClassifier(
    objective='binary_logistic',
    max_depth=6,
    learning_rate=0.1,
    n_estimators=100,
    random_state=42
)

xgb_model.fit(X_train, y_train)

# äºˆæ¸¬ã¨è©•ä¾¡
y_pred = xgb_model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)

print("XGBoostç²¾åº¦", accuracy)</code></pre>
            </section>

            <section>
                <h2>ğŸ¯ ã¾ã¨ã‚</h2>
                <p>
                    æœ¬è¨˜äº‹ã§ã¯ã€Pythonã¨pandasã‚’ä½¿ã£ãŸç«¶é¦¬ãƒ‡ãƒ¼ã‚¿åˆ†æã®åŸºç¤ã‹ã‚‰ã€XGBoostã«ã‚ˆã‚‹é«˜ç²¾åº¦äºˆæƒ³ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã¾ã§è§£èª¬ã—ã¾ã—ãŸã€‚
                    ç‰¹ã«é‡è¦ãªã®ã¯ä»¥ä¸‹ã®ãƒã‚¤ãƒ³ãƒˆã§ã™ï¼š
                </p>

                <div class="summary-box">
                    <h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>
                    <ul>
                        <li><strong>ãƒ‡ãƒ¼ã‚¿å“è³ª</strong>: å‰å‡¦ç†ã¨ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ãŒãƒ¢ãƒ‡ãƒ«æ€§èƒ½ã«æœ€ã‚‚å½±éŸ¿</li>
                        <li><strong>éå»æˆç¸¾ç‰¹å¾´é‡</strong>: é¦¬ã®éå»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€ã‚‚é‡è¦ãªç‰¹å¾´é‡</li>
                        <li><strong>ãƒ¢ãƒ‡ãƒ«é¸æŠ</strong>: XGBoostã¯ç«¶é¦¬ãƒ‡ãƒ¼ã‚¿ã«ç‰¹ã«æœ‰åŠ¹</li>
                        <li><strong>è©•ä¾¡æŒ‡æ¨™</strong>: å˜ç´”ãªç²¾åº¦ã ã‘ã§ãªãã€AUCã‚„ç¢ºç‡è¼ƒæ­£ã‚‚é‡è¦</li>
                    </ul>
                </div>

                <p>
                    ã•ã‚‰ã«é«˜åº¦ãªæ‰‹æ³•ï¼ˆæ·±å±¤å­¦ç¿’ã€ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ã€æ™‚ç³»åˆ—åˆ†æãªã©ï¼‰ã«æŒ‘æˆ¦ã™ã‚‹ã“ã¨ã§ã€
                    ã‚ˆã‚Šç²¾åº¦ã®é«˜ã„äºˆæƒ³ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚
                </p>
            </section>

            <div class="article-navigation">
                <div class="nav-prev">
                    <a href="/machine-learning/">â† æ©Ÿæ¢°å­¦ç¿’è¨˜äº‹ä¸€è¦§</a>
                </div>
                <div class="nav-next">
                    <a href="/deep-learning/lstm-time-series-tensorflow/">LSTMæ™‚ç³»åˆ—ãƒ¢ãƒ‡ãƒ« â†’</a>
                </div>
            </div>
        </div>
    </article>
</BaseLayout>

<style>
    .article-content {
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 20px;
        line-height: 1.8;
        color: #e2e8f0;
    }

    .article-header {
        margin-bottom: 40px;
        padding-bottom: 20px;
        border-bottom: 2px solid rgba(59, 130, 246, 0.3);
    }

    .breadcrumb {
        color: #94a3b8;
        margin-bottom: 15px;
        font-size: 0.9rem;
    }

    .breadcrumb a {
        color: #60a5fa;
        text-decoration: none;
    }

    .breadcrumb a:hover {
        text-decoration: underline;
    }

    .article-category {
        background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        color: white;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
        display: inline-block;
        margin-bottom: 15px;
    }

    .article-title {
        font-size: 2.5rem;
        font-weight: 800;
        margin: 20px 0;
        background: linear-gradient(135deg, #60a5fa, #c084fc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        line-height: 1.2;
    }

    .article-meta {
        color: #94a3b8;
        font-size: 0.9rem;
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }

    .article-body {
        color: #cbd5e1;
    }

    .article-body h2 {
        color: #60a5fa;
        font-size: 1.8rem;
        font-weight: 700;
        margin: 40px 0 20px 0;
        padding-bottom: 10px;
        border-bottom: 2px solid rgba(59, 130, 246, 0.2);
    }

    .article-body h3 {
        color: #fbbf24;
        font-size: 1.3rem;
        font-weight: 600;
        margin: 30px 0 15px 0;
    }

    .article-body p {
        margin-bottom: 20px;
        line-height: 1.8;
    }

    .highlight-box, .summary-box {
        background: rgba(59, 130, 246, 0.1);
        border: 1px solid rgba(59, 130, 246, 0.3);
        border-radius: 12px;
        padding: 25px;
        margin: 25px 0;
    }

    .highlight-box h3, .summary-box h3 {
        color: #60a5fa;
        margin-top: 0;
        margin-bottom: 15px;
    }

    .highlight-box ul, .summary-box ul {
        margin: 0;
        padding-left: 20px;
    }

    .highlight-box li, .summary-box li {
        margin-bottom: 8px;
        color: #e2e8f0;
    }

    pre {
        background: rgba(15, 23, 42, 0.8);
        border: 1px solid rgba(59, 130, 246, 0.3);
        border-radius: 8px;
        padding: 20px;
        overflow-x: auto;
        margin: 20px 0;
        font-family: 'JetBrains Mono', 'Fira Code', monospace;
        font-size: 0.9rem;
        line-height: 1.6;
    }

    code {
        color: #fbbf24;
        font-family: 'JetBrains Mono', 'Fira Code', monospace;
    }

    .article-navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 60px;
        padding-top: 30px;
        border-top: 1px solid rgba(59, 130, 246, 0.3);
    }

    .nav-prev a, .nav-next a {
        color: #60a5fa;
        text-decoration: none;
        padding: 12px 20px;
        border: 1px solid rgba(59, 130, 246, 0.3);
        border-radius: 8px;
        transition: all 0.3s ease;
    }

    .nav-prev a:hover, .nav-next a:hover {
        background: rgba(59, 130, 246, 0.1);
        border-color: #60a5fa;
    }

    /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
    @media (max-width: 768px) {
        .article-content {
            padding: 20px 15px;
        }

        .article-title {
            font-size: 2rem;
        }

        .article-meta {
            flex-direction: column;
            gap: 10px;
        }

        .article-navigation {
            flex-direction: column;
            gap: 15px;
        }

        pre {
            font-size: 0.8rem;
            padding: 15px;
        }
    }
</style>