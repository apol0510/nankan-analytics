---
// ä¼šå“¡ä½“é¨“å®Œå…¨ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ - ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ
export const prerender = false;
---

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼šå“¡ä½“é¨“å®Œå…¨ãƒ†ã‚¹ãƒˆ | NANKANã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #e2e8f0;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .header h1 {
            color: #3b82f6;
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .test-card {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(59, 130, 246, 0.2);
            text-align: center;
        }

        .test-card h2 {
            color: #3b82f6;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .test-steps {
            text-align: left;
            background: rgba(15, 23, 42, 0.6);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .test-steps h3 {
            color: #8b5cf6;
            margin-bottom: 15px;
        }

        .test-steps ol {
            list-style: none;
            counter-reset: step-counter;
        }

        .test-steps li {
            counter-increment: step-counter;
            margin-bottom: 12px;
            padding-left: 30px;
            position: relative;
        }

        .test-steps li::before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: #3b82f6;
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .test-btn {
            background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            margin: 10px;
        }

        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.4);
        }

        .test-btn.standard {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .test-btn.premium {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .test-btn.reset {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        }

        .flow-section {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .flow-section h2 {
            color: #3b82f6;
            margin-bottom: 20px;
        }

        .flow-arrows {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
        }

        .flow-step {
            background: rgba(59, 130, 246, 0.1);
            padding: 12px 20px;
            border-radius: 8px;
            border: 1px solid rgba(59, 130, 246, 0.3);
            text-align: center;
            flex: 1;
            min-width: 150px;
        }

        .flow-arrow {
            color: #3b82f6;
            font-size: 1.5rem;
        }

        .warning-box {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .warning-box h4 {
            color: #ef4444;
            margin-bottom: 8px;
        }

        .status-indicator {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .status-active {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .status-inactive {
            background: rgba(107, 114, 128, 0.2);
            color: #9ca3af;
        }

        .current-status {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            border-left: 4px solid #3b82f6;
        }

        .quick-links {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .quick-link {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            transition: all 0.3s ease;
            border: 1px solid rgba(59, 130, 246, 0.3);
        }

        .quick-link:hover {
            background: rgba(59, 130, 246, 0.2);
        }

        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
            
            .flow-arrows {
                flex-direction: column;
            }
            
            .flow-arrow {
                transform: rotate(90deg);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” ä¼šå“¡ä½“é¨“å®Œå…¨ãƒ†ã‚¹ãƒˆ</h1>
            <p>Standardãƒ»Premiumä¼šå“¡ã¨ã—ã¦ã®å…¨ãƒ•ãƒ­ãƒ¼æ¤œè¨¼</p>
        </div>

        <div class="current-status">
            <h3>ğŸ“Š ç¾åœ¨ã®ãƒ†ã‚¹ãƒˆçŠ¶æ…‹</h3>
            <p>ç¾åœ¨ã®ãƒ†ã‚¹ãƒˆä¼šå“¡çŠ¶æ…‹: <span id="current-membership-status">æœªè¨­å®š</span></p>
            <p>æœ€çµ‚æ›´æ–°: <span id="last-update-time">-</span></p>
        </div>

        <div class="test-grid">
            <!-- Standardä¼šå“¡ãƒ†ã‚¹ãƒˆ -->
            <div class="test-card">
                <h2>ğŸ“š Standardä¼šå“¡ãƒ†ã‚¹ãƒˆ</h2>
                <div class="test-steps">
                    <h3>ğŸ¯ ãƒ†ã‚¹ãƒˆé …ç›®</h3>
                    <ol>
                        <li>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºç¢ºèª</li>
                        <li>10Rãƒ»11Rãƒ»12Räºˆæƒ³ã‚¢ã‚¯ã‚»ã‚¹</li>
                        <li>1R-9Råˆ¶é™è¡¨ç¤ºç¢ºèª</li>
                        <li>æ±ºæ¸ˆç”»é¢é·ç§»ãƒ†ã‚¹ãƒˆ</li>
                        <li>ãƒ—ãƒ©ãƒ³å¤‰æ›´æ©Ÿèƒ½ç¢ºèª</li>
                    </ol>
                </div>
                <button class="test-btn standard" onclick="setStandardMembership()">
                    Standardä¼šå“¡ã¨ã—ã¦ä½“é¨“é–‹å§‹
                </button>
                <div class="quick-links">
                    <a href="/dashboard" class="quick-link" target="_blank">ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
                    <a href="/" class="quick-link" target="_blank">ğŸ‡ äºˆæƒ³ãƒšãƒ¼ã‚¸</a>
                </div>
            </div>

            <!-- Premiumä¼šå“¡ãƒ†ã‚¹ãƒˆ -->
            <div class="test-card">
                <h2>ğŸ‘‘ Premiumä¼šå“¡ãƒ†ã‚¹ãƒˆ</h2>
                <div class="test-steps">
                    <h3>ğŸ¯ ãƒ†ã‚¹ãƒˆé …ç›®</h3>
                    <ol>
                        <li>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºç¢ºèª</li>
                        <li>1R-12Rå…¨äºˆæƒ³ã‚¢ã‚¯ã‚»ã‚¹</li>
                        <li>AIåˆ†æãƒ¬ãƒãƒ¼ãƒˆé–²è¦§</li>
                        <li>ç„¡åˆ¶é™ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹</li>
                        <li>å„ªå…ˆã‚µãƒãƒ¼ãƒˆè¡¨ç¤º</li>
                    </ol>
                </div>
                <button class="test-btn premium" onclick="setPremiumMembership()">
                    Premiumä¼šå“¡ã¨ã—ã¦ä½“é¨“é–‹å§‹
                </button>
                <div class="quick-links">
                    <a href="/dashboard" class="quick-link" target="_blank">ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</a>
                    <a href="/" class="quick-link" target="_blank">ğŸ‡ äºˆæƒ³ãƒšãƒ¼ã‚¸</a>
                </div>
            </div>
        </div>

        <!-- æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ -->
        <div class="flow-section">
            <h2>ğŸ’³ æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼å®Œå…¨ãƒ†ã‚¹ãƒˆ</h2>
            <div class="flow-arrows">
                <div class="flow-step">æ–™é‡‘ãƒ—ãƒ©ãƒ³é¸æŠ</div>
                <span class="flow-arrow">â†’</span>
                <div class="flow-step">Stripeãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ</div>
                <span class="flow-arrow">â†’</span>
                <div class="flow-step">æ±ºæ¸ˆå®Œäº†</div>
                <span class="flow-arrow">â†’</span>
                <div class="flow-step">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰é·ç§»</div>
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <a href="/pricing" class="test-btn">ğŸ’³ æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼é–‹å§‹</a>
                <a href="/pricing-test-simple" class="test-btn">ğŸ§ª ãƒ¢ãƒƒã‚¯æ±ºæ¸ˆãƒ†ã‚¹ãƒˆ</a>
            </div>

            <div class="warning-box">
                <h4>âš ï¸ æ±ºæ¸ˆãƒ†ã‚¹ãƒˆæ³¨æ„äº‹é …</h4>
                <p>â€¢ å®Ÿéš›ã®æ±ºæ¸ˆãƒ†ã‚¹ãƒˆã¯Stripeãƒ†ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œã—ã¦ãã ã•ã„</p>
                <p>â€¢ ãƒ†ã‚¹ãƒˆç”¨ã‚«ãƒ¼ãƒ‰: 4242 4242 4242 4242</p>
                <p>â€¢ æœ‰åŠ¹æœŸé™: ä»»æ„ã®å°†æ¥æ—¥ä»˜ã€CVC: ä»»æ„ã®3æ¡</p>
            </div>
        </div>

        <!-- æ¤œè¨¼é …ç›®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ -->
        <div class="flow-section">
            <h2>âœ… æ¤œè¨¼é …ç›®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <div class="test-steps">
                    <h3>ğŸ¯ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ¤œè¨¼</h3>
                    <ol>
                        <li>ãƒ—ãƒ©ãƒ³è¡¨ç¤ºæ­£ç¢ºæ€§</li>
                        <li>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º(active/inactive)</li>
                        <li>ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãƒ¬ãƒ¼ã‚¹è¡¨ç¤º</li>
                        <li>æ¬¡å›æ›´æ–°æ—¥è¡¨ç¤º</li>
                        <li>ãƒ—ãƒ©ãƒ³å¤‰æ›´ãƒœã‚¿ãƒ³å‹•ä½œ</li>
                    </ol>
                </div>
                
                <div class="test-steps">
                    <h3>ğŸ‡ äºˆæƒ³ãƒšãƒ¼ã‚¸æ¤œè¨¼</h3>
                    <ol>
                        <li>ç„¡æ–™ãƒ¬ãƒ¼ã‚¹(11R)ã‚¢ã‚¯ã‚»ã‚¹</li>
                        <li>Standardåˆ¶é™ãƒ¬ãƒ¼ã‚¹ç¢ºèª</li>
                        <li>Premiumå…¨ãƒ¬ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹</li>
                        <li>åˆ¶é™æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º</li>
                        <li>ä¼šå“¡ç™»éŒ²èª˜å°è¡¨ç¤º</li>
                    </ol>
                </div>
                
                <div class="test-steps">
                    <h3>ğŸ’³ æ±ºæ¸ˆãƒ•ãƒ­ãƒ¼æ¤œè¨¼</h3>
                    <ol>
                        <li>æ–™é‡‘ãƒ—ãƒ©ãƒ³é¸æŠç”»é¢</li>
                        <li>Stripeæ±ºæ¸ˆç”»é¢é·ç§»</li>
                        <li>æ±ºæ¸ˆå®Œäº†å¾Œãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ</li>
                        <li>ä¼šå“¡æƒ…å ±å³æ™‚æ›´æ–°</li>
                        <li>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å‹•ä½œ</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ -->
        <div style="text-align: center; margin-top: 40px;">
            <button class="test-btn reset" onclick="resetMembership()">
                ğŸ”„ ãƒ†ã‚¹ãƒˆçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            </button>
            <p style="margin-top: 15px; color: #64748b; font-size: 0.9rem;">
                ãƒ†ã‚¹ãƒˆå®Œäº†å¾Œã¯å¿…ãšãƒªã‚»ãƒƒãƒˆã—ã¦ãã ã•ã„
            </p>
        </div>

        <div style="text-align: center; margin-top: 40px; color: #64748b;">
            <p>ğŸ¤– powered by pricing-final.astro approach | ãƒã‚³&ã‚¯ãƒ­ã®ä¼šå“¡ä½“é¨“ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ </p>
        </div>
    </div>

    <script type="module">
        import { createClient } from 'https://cdn.skypack.dev/@supabase/supabase-js'

        // Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆåˆæœŸåŒ–ï¼ˆãƒ¡ã‚¿ã‚¿ã‚°ã‹ã‚‰å–å¾—ï¼‰
        const supabaseUrl = 'https://pqjlotjgbhsfqimqrxvn.supabase.co'
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBxamxvdGpnYmhzZnFpbXFyeHZuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjE0Njk3MDgsImV4cCI6MjAzNzA0NTcwOH0.z8j3E9I8W-yI_WQoSYVzUKKNcpR1rH5JpNE4w6_NL24'
        const supabase = createClient(supabaseUrl, supabaseKey)

        // ç¾åœ¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—
        let currentUser = null

        window.setStandardMembership = async function() {
            currentUser = await getCurrentUser()
            if (!currentUser) {
                alert('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚ã¾ãšèªè¨¼ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚')
                return
            }

            const testData = {
                planType: 'standard',
                status: 'active',
                createdAt: new Date().toISOString(),
                price: 'Â¥5,980',
                features: ['10Rãƒ»11Rãƒ»12Räºˆæƒ³', 'åŸºç¤ã‚³ãƒ³ãƒ†ãƒ³ãƒ„', 'ãƒ¡ãƒ¼ãƒ«ã‚µãƒãƒ¼ãƒˆ']
            }

            localStorage.setItem('test_subscription_' + currentUser.id, JSON.stringify(testData))
            
            updateStatus('Standardä¼šå“¡', 'active')
            alert('âœ… Standardä¼šå“¡ã¨ã—ã¦è¨­å®šã•ã‚Œã¾ã—ãŸï¼\n\nãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ã„ã¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚')
        }

        window.setPremiumMembership = async function() {
            currentUser = await getCurrentUser()
            if (!currentUser) {
                alert('ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™ã€‚ã¾ãšèªè¨¼ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚')
                return
            }

            const testData = {
                planType: 'premium',
                status: 'active',
                createdAt: new Date().toISOString(),
                price: 'Â¥9,980',
                features: ['1R-12Rå…¨äºˆæƒ³', 'å…¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„', 'AIåˆ†æãƒ¬ãƒãƒ¼ãƒˆ', 'å„ªå…ˆã‚µãƒãƒ¼ãƒˆ']
            }

            localStorage.setItem('demo_subscription_' + currentUser.id, JSON.stringify(testData))
            
            updateStatus('Premiumä¼šå“¡', 'active')
            alert('âœ… Premiumä¼šå“¡ã¨ã—ã¦è¨­å®šã•ã‚Œã¾ã—ãŸï¼\n\nãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’é–‹ã„ã¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚')
        }

        window.resetMembership = async function() {
            currentUser = await getCurrentUser()
            if (!currentUser) {
                alert('ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚')
                return
            }

            // ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤
            localStorage.removeItem('test_subscription_' + currentUser.id)
            localStorage.removeItem('demo_subscription_' + currentUser.id)
            
            updateStatus('æœªè¨­å®š', 'inactive')
            alert('ğŸ”„ ãƒ†ã‚¹ãƒˆçŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸã€‚\n\né€šå¸¸ã®ç„¡æ–™ä¼šå“¡çŠ¶æ…‹ã«æˆ»ã‚Šã¾ã—ãŸã€‚')
        }

        function updateStatus(planName, status) {
            const statusElement = document.getElementById('current-membership-status')
            const timeElement = document.getElementById('last-update-time')
            
            statusElement.textContent = planName
            statusElement.className = `status-indicator ${status === 'active' ? 'status-active' : 'status-inactive'}`
            
            timeElement.textContent = new Date().toLocaleString('ja-JP')
        }

        async function getCurrentUser() {
            try {
                const { data: { session } } = await supabase.auth.getSession()
                return session?.user || null
            } catch (error) {
                console.error('Error getting user:', error)
                return null
            }
        }

        // åˆæœŸçŠ¶æ…‹ç¢ºèª
        document.addEventListener('DOMContentLoaded', async function() {
            currentUser = await getCurrentUser()
            if (currentUser) {
                const testSub = localStorage.getItem('test_subscription_' + currentUser.id)
                const demoSub = localStorage.getItem('demo_subscription_' + currentUser.id)
                
                if (testSub) {
                    const data = JSON.parse(testSub)
                    updateStatus('Standardä¼šå“¡ (ãƒ†ã‚¹ãƒˆ)', 'active')
                } else if (demoSub) {
                    const data = JSON.parse(demoSub)
                    updateStatus('Premiumä¼šå“¡ (ãƒ†ã‚¹ãƒˆ)', 'active')
                } else {
                    updateStatus('æœªè¨­å®š', 'inactive')
                }
            } else {
                updateStatus('ãƒ­ã‚°ã‚¤ãƒ³å¿…è¦', 'inactive')
            }
        })
    </script>
</body>
</html>